import{r as o,j as e}from"./main-BbfualH5.js";import{T as _}from"./ToolInfo-DFE14Gws.js";import{J as O}from"./jszip.min-DHrppeb5.js";import{I as K}from"./IconCloudUpload-1Uhxj5gK.js";import{I as R}from"./IconLock-CmLX9kGH.js";import{I as S}from"./IconDownload-BU5neXtF.js";import{I as X}from"./IconCircleX-BjNpJg6R.js";import{I as Y}from"./IconBolt-BW-kM6kb.js";import{I as V}from"./IconArrowsMinimize-B-1Lf2bU.js";function de(){const[i,p]=o.useState([]),[g,D]=o.useState(.3),[u,U]=o.useState(1920),[h,L]=o.useState(1080),[b,j]=o.useState(!1),[w,N]=o.useState(!1),[l,P]=o.useState(!0),y=o.useRef(null),[C,M]=o.useState(!1),E=s=>{const t=Array.from(s.target.files||[]);F(t)},B=s=>{s.preventDefault(),j(!0)},A=s=>{s.preventDefault(),j(!1)},Z=s=>{s.preventDefault(),j(!1);const t=Array.from(s.dataTransfer.files);F(t)},F=s=>{const t=s.filter(r=>r.type.startsWith("image/"));if(t.length===0){alert("Please select valid image files");return}const a=t.map(r=>({id:`${Date.now()}-${Math.random()}`,name:r.name,originalSize:r.size,originalFile:r,status:"ready",ext:r.name.split(".").pop()?.toLowerCase()||"jpg",mimeType:r.type,preview:URL.createObjectURL(r)}));p(a)},$=async s=>new Promise((t,a)=>{const r=new Image;r.onload=()=>{try{const n=document.createElement("canvas"),m=n.getContext("2d");if(!m){a(new Error("Failed to get canvas context"));return}let{width:c,height:d}=r;if(c>u||d>h){const x=Math.min(u/c,h/d);c=Math.round(c*x),d=Math.round(d*x)}n.width=c,n.height=d,s.mimeType==="image/png"&&l?m.clearRect(0,0,c,d):(m.fillStyle="#FFFFFF",m.fillRect(0,0,c,d)),m.drawImage(r,0,0,c,d);const k=l?s.mimeType:"image/jpeg",W=k==="image/jpeg"?g:void 0;n.toBlob(x=>{if(x){const f=x.size<s.originalSize?x:s.originalFile,H=(s.originalSize-f.size)/s.originalSize*100;p(Q=>Q.map(v=>v.id===s.id?{...v,status:"completed",compressedSize:f.size,compressedBlob:f,downloadUrl:URL.createObjectURL(f),compressionRatio:Math.max(0,H)}:v)),t()}else a(new Error("Compression failed"))},k,W)}catch(n){a(n)}finally{URL.revokeObjectURL(r.src)}},r.onerror=()=>{a(new Error("Failed to load image")),URL.revokeObjectURL(r.src)},r.src=URL.createObjectURL(s.originalFile)}),G=async s=>{if(s.length!==0){N(!0);for(const t of s)try{p(a=>a.map(r=>r.id===t.id?{...r,status:"compressing"}:r)),await $(t)}catch(a){p(r=>r.map(n=>n.id===t.id?{...n,status:"error",error:a.message}:n))}N(!1)}},T=s=>{if(!s.downloadUrl)return;const t=document.createElement("a");t.href=s.downloadUrl;const a=s.name.replace(/\.[^/.]+$/,""),r=l?s.ext:"jpg";t.download=`compressed_${a}.${r}`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},q=async()=>{const s=i.filter(t=>t.status==="completed"&&t.compressedBlob);if(s.length===0){alert("No compressed files available for download.");return}try{const t=new O;for(const n of s)if(n.compressedBlob){const m=`${n.name.split(".")[0]}.${l?n.ext:"jpg"}`;t.file(m,n.compressedBlob)}const a=await t.generateAsync({type:"blob"}),r=document.createElement("a");r.href=URL.createObjectURL(a),r.download=`compressed_images_${Date.now()}.zip`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href)}catch(t){console.error("Error creating ZIP file:",t),alert("Failed to create ZIP file")}finally{M(!1)}},I=s=>{if(s===0)return"0 Bytes";const t=1024,a=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,r)).toFixed(2))+" "+a[r]},J=()=>{i.forEach(s=>{s.downloadUrl&&URL.revokeObjectURL(s.downloadUrl)}),p([]),y.current&&(y.current.value="")};o.useEffect(()=>{const s=i.filter(t=>t.status==="ready");s.length>0&&!w&&G(s)},[i,w]),o.useEffect(()=>{i.length>0&&p(s=>s.map(t=>({...t,status:"ready"})))},[g,u,h,l]);const z=i.filter(s=>s.status==="completed").length;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-800 to-slate-900 pt-24 pb-8 px-4 flex flex-col items-center justify-between",children:[e.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col items-center justify-center mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-100 mb-2",children:["Image ",e.jsx("span",{className:"text-brand-primary",children:"Compressor"})]}),e.jsx("p",{className:"text-md text-gray-200",children:"Reduce file size up to 80% while preserving quality. 100% client-side—your files never leave."})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl shadow-lg p-4 sm:p-8 mb-6 w-full max-w-5xl",children:i.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{onDragOver:B,onDragLeave:A,onDrop:Z,className:`border-3 border-dashed rounded-lg p-12 text-center transition-all duration-300 ${b?"border-brand-primary bg-brand-primary/20":"border-gray-600 hover:border-brand-primary/40 hover:bg-gray-700"}`,children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(K,{className:`w-16 h-16 ${b?"text-brand-primary":"text-gray-400"} transition-colors`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-medium text-gray-100 mb-2",children:b?"Drop your images here":"Drag & drop your images here"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"or"}),e.jsx("button",{onClick:()=>y.current?.click(),className:"text-sm px-3 py-2 bg-brand-primary text-white rounded-lg hover:bg-brand-hover transition-colors duration-200 font-medium shadow-md hover:shadow-lg",children:"Choose Files"})]})]})}),e.jsxs("p",{className:"text-center text-gray-400 text-xs mt-3 flex items-center justify-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"})," Your files stay on your device. Nothing is uploaded to any server."]}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,ref:y,className:"hidden",onChange:E})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:"Compression Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:s=>P(s.target.checked),className:"w-4 h-4 text-brand-primary bg-gray-700 border-gray-600 rounded focus:ring-brand-primary"}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Preserve original format"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:l?"Keep original file formats (PNG, JPEG, etc.)":"Convert all images to JPEG for better compression"})]}),(!l||i.some(s=>s.mimeType==="image/jpeg"))&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-200",children:["Quality ",l?"(JPEG only)":""]}),e.jsxs("span",{className:"text-sm text-brand-primary font-medium",children:[Math.round(g*100),"%"]})]}),e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:g,onChange:s=>D(parseFloat(s.target.value)),className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"Lower quality"}),e.jsx("span",{children:"Higher quality"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Max Width (px)"}),e.jsx("input",{type:"number",value:u,onChange:s=>U(parseInt(s.target.value)||1920),min:"100",max:"4000",className:"w-full px-3 py-2 border border-gray-600 rounded bg-gray-700 text-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-brand-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Max Height (px)"}),e.jsx("input",{type:"number",value:h,onChange:s=>L(parseInt(s.target.value)||1080),min:"100",max:"4000",className:"w-full px-3 py-2 border border-gray-600 rounded bg-gray-700 text-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-brand-primary"})]})]})]}),e.jsxs("div",{className:"w-full flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-100 mb-4",children:["Files (",i.length,")"]}),i.length>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:J,className:"px-4 py-2 text-red-400 hover:bg-red-900/20 rounded-lg transition-colors duration-200",children:"Clear All"})})]}),e.jsx("div",{className:"space-y-3",children:i.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-600 rounded-lg bg-gray-700",children:[e.jsx("div",{className:"mr-4 flex-shrink-0",children:e.jsx("img",{src:s.preview,alt:s.name,className:"w-16 h-16 object-contain rounded-md"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-1",children:e.jsx("p",{className:"font-medium text-gray-100 truncate",children:s.name})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 flex-wrap",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[I(s.originalSize)," →",s.compressedSize&&e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-xs bg-green-900 text-green-300",children:I(s.compressedSize)})})]}),s.error&&e.jsx("span",{className:"text-xs text-red-400",children:s.error})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 ml-4",children:[s.status==="ready"&&e.jsx("span",{className:"text-gray-400 text-sm",children:"Ready"}),s.status==="compressing"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-brand-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-brand-primary text-sm",children:"Compressing..."})]}),s.status==="completed"&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>T(s),className:"px-3 py-1 bg-green-700 text-green-100 text-sm rounded hover:bg-green-600 transition-colors",children:e.jsx(S,{className:"w-4 h-4"})})}),s.status==="error"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-400 text-sm",children:"Failed"})]})]})]},s.id))}),z>0&&e.jsx("div",{className:"mt-6 w-full flex justify-end",children:e.jsx("button",{onClick:q,disabled:C,className:"px-4 py-2 bg-green-700 text-green-100 rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium shadow-md hover:shadow-lg flex items-center space-x-2",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-300 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Creating ZIP..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4"}),e.jsxs("span",{children:["Download ZIP (",z,")"]})]})})})]})}),e.jsx(_,{title:"Image Compressor",description:"Our Image Compressor helps you significantly reduce the file size of your images without sacrificing visible quality. By utilizing advanced browser-based compression algorithms, you can optimize your PNG, JPEG, and WebP files for faster web loading and reduced storage usage.",features:[{title:"Quality Control",description:"Fine-tune the compression level to find the perfect balance between file size and image clarity.",icon:Y},{title:"Privacy Guaranteed",description:"Processing happens entirely in your browser. No images are ever uploaded to a server.",icon:R},{title:"Bulk Compression",description:"Compress dozens of images simultaneously and download them all at once in a ZIP file.",icon:V}],steps:[{title:"Add Images",description:"Drop your images into the compression zone or use the file picker to select them."},{title:"Adjust Settings",description:"Set your desired quality and maximum dimensions to optimize your images further."},{title:"Review Savings",description:"Instantly see how much space you have saved for each image after compression."},{title:"Download All",description:"Download individual optimized images or grab the entire batch as a ZIP archive."}]})]}),e.jsx("div",{className:"mt-8",children:e.jsxs("p",{className:"text-gray-400 text-xs text-center",children:["Crafted with care by"," ",e.jsx("a",{href:"https://sidme.vercel.app/",target:"_blank",rel:"noopener noreferrer",className:"text-brand-primary hover:text-brand-hover transition-colors",children:"sidme"})]})}),e.jsx("style",{children:`
        .slider::-webkit-slider-thumb {
          appearance: none;
          height: 20px;
          width: 20px;
          border-radius: 50%;
          background: var(--brand-primary);
          cursor: pointer;
        }
        .slider::-moz-range-thumb {
          height: 20px;
          width: 20px;
          border-radius: 50%;
          background: var(--brand-primary);
          cursor: pointer;
          border: none;
        }
      `})]})}export{de as component};
